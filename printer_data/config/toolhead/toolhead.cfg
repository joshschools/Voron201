# Toolhead Configuration: Extruder, Hotend, Fans, Sensors, Probe

# --- Extruder ---
[extruder]
step_pin = EBBCan:gpio18
dir_pin = EBBCan:gpio19
enable_pin = !EBBCan:gpio17
rotation_distance = 22.278
max_extrude_only_distance = 110
gear_ratio = 50:10
microsteps = 16
full_steps_per_rotation = 200
nozzle_diameter = 0.400
filament_diameter = 1.75
heater_pin = EBBCan:gpio7
sensor_type = PT1000
sensor_pin = EBBCan:gpio27
min_temp = 10
max_temp = 280
max_power = 1.0
min_extrude_temp = 10
max_extrude_cross_section = 5
pressure_advance = 0.038
pressure_advance_smooth_time = 0.040
# PID values are auto-generated in printer.cfg

[tmc2209 extruder]
uart_pin = EBBCan:gpio20
interpolate = true
run_current = 0.650
stealthchop_threshold = 0
sense_resistor = 0.11

[autotune_tmc extruder]
motor = moons-cse14hra1l410a

[firmware_retraction]
retract_length = 0.8
retract_speed = 30
unretract_speed = 30

# --- Toolhead Fans ---
# Part Cooling Fan
[fan]
pin = EBBCan:gpio13
kick_start_time = 0.25
hardware_pwm = false
cycle_time = 0.01

# Hotend Fan
[heater_fan hotend_fan]
pin = EBBCan:gpio14
heater = extruder
heater_temp = 50.0
kick_start_time = 0.25
hardware_pwm = false
cycle_time = 0.01

# --- Probe (Cartographer) ---
[cartographer]
mcu: cartographer
x_offset = 0
y_offset = -20
backlash_comp = 0.01168
sensor = cartographer
sensor_alt = carto
mesh_runs = 2
mode = touch
scanner_touch_threshold = 1250
scanner_touch_speed = 3
scanner_touch_z_offset = 0.140